@echo off
chcp 65001 >nul
title EYM Agent è‡ªå‹•èµ·å‹•è¨­å®š

echo.
echo ========================================
echo   EYM Agent è‡ªå‹•èµ·å‹•è¨­å®š
echo ========================================
echo.
echo ã“ã®ãƒ„ãƒ¼ãƒ«ã¯EYM Agentã‚’Windowsèµ·å‹•æ™‚ã«
echo ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ã§è‡ªå‹•èµ·å‹•ã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚
echo.
echo è¨­å®šå†…å®¹:
echo - Windowsèµ·å‹•æ™‚ã«EYM Agentã‚’è‡ªå‹•èµ·å‹•
echo - ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ã«æœ€å°åŒ–ã—ã¦èµ·å‹•
echo - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ä½œ
echo.

:: ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
    echo.
    echo è§£æ±ºæ–¹æ³•:
    echo 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
    echo 2. "ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œ" ã‚’é¸æŠž
    echo 3. UACï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ï¼‰ã§ã€Œã¯ã„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 1
)

echo âœ“ ç®¡ç†è€…æ¨©é™ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
echo.

:: ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
set "CURRENT_DIR=%~dp0"
set "EXE_PATH=%CURRENT_DIR%eym_agent.exe"

:: EXEãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
if not exist "%EXE_PATH%" (
    echo âŒ EYM Agentã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚
    echo.
    echo ç¢ºèªã—ã¦ãã ã•ã„:
    echo - eym_agent.exe ãŒåŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ã‹
    echo - ãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£ã—ã„ã‹
    echo.
    echo æ¤œç´¢ãƒ‘ã‚¹: %EXE_PATH%
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 1
)

echo âœ“ EYM Agentå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
echo ãƒ‘ã‚¹: %EXE_PATH%
echo.

:: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«è‡ªå‹•èµ·å‹•ã‚’ç™»éŒ²
echo Windowsèµ·å‹•æ™‚ã®è‡ªå‹•èµ·å‹•ã‚’è¨­å®šä¸­...
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "EYM Agent" /t REG_SZ /d "\"%EXE_PATH%\"" /f >nul 2>&1

if %errorlevel% == 0 (
    echo.
    echo âœ… è‡ªå‹•èµ·å‹•è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸï¼
    echo.
    echo è¨­å®šå†…å®¹:
    echo - ç™»éŒ²å: EYM Agent
    echo - å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«: %EXE_PATH%
    echo - èµ·å‹•æ–¹æ³•: ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ã«æœ€å°åŒ–
    echo.
    echo ðŸŽ‰ æ¬¡å›žã®Windowsèµ·å‹•æ™‚ã‹ã‚‰è‡ªå‹•ã§èµ·å‹•ã—ã¾ã™ï¼
    echo.
    echo å‹•ä½œç¢ºèª:
    echo 1. PCã‚’å†èµ·å‹•
    echo 2. ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ï¼ˆç”»é¢å³ä¸‹ï¼‰ã«EYM Agentã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    echo 3. ã‚¢ã‚¤ã‚³ãƒ³ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º
    echo 4. ã‚¹ãƒžãƒ›ã‹ã‚‰æŽ¥ç¶šãƒ†ã‚¹ãƒˆ
    echo.
    echo ðŸ“ ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ã®ä½¿ã„æ–¹:
    echo - å³ã‚¯ãƒªãƒƒã‚¯: ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º
    echo - "ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤º": ãƒ¡ã‚¤ãƒ³ç”»é¢ã‚’é–‹ã
    echo - "QRã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º": æŽ¥ç¶šç”¨QRã‚³ãƒ¼ãƒ‰è¡¨ç¤º
    echo - "çµ‚äº†": ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†
    echo.
    echo ðŸ“ æ³¨æ„äº‹é …:
    echo - è‡ªå‹•èµ·å‹•ã‚’ç„¡åŠ¹ã«ã—ãŸã„å ´åˆã¯ remove_autostart.bat ã‚’å®Ÿè¡Œ
    echo - ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚‚å¿…è¦ã§ã™ï¼ˆsetup_firewall.batï¼‰
    echo.
) else (
    echo.
    echo âŒ è‡ªå‹•èµ·å‹•è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸã€‚
    echo.
    echo è€ƒãˆã‚‰ã‚Œã‚‹åŽŸå› :
    echo - ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ä¸è¶³
    echo - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚½ãƒ•ãƒˆã«ã‚ˆã‚‹å¹²æ¸‰
    echo - ã‚·ã‚¹ãƒ†ãƒ ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹åˆ¶é™
    echo.
    echo æ‰‹å‹•è¨­å®šæ–¹æ³•:
    echo 1. Win + R ã‚­ãƒ¼ã‚’æŠ¼ã™
    echo 2. "shell:startup" ã¨å…¥åŠ›ã—ã¦Enter
    echo 3. é–‹ã„ãŸãƒ•ã‚©ãƒ«ãƒ€ã«EYM Agentã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œæˆ
    echo 4. ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®Ÿè¡Œæ™‚ã®å¤§ãã•ã‚’ã€Œæœ€å°åŒ–ã€ã«è¨­å®š
    echo.
)

echo.
echo è¨­å®šç¢ºèªæ–¹æ³•:
echo 1. Win + R â†’ "msconfig" â†’ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¿ãƒ–
echo 2. ã¾ãŸã¯ ã‚¿ã‚¹ã‚¯ãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼ â†’ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¿ãƒ–
echo 3. "EYM Agent" ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
echo.
echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
pause >nul
