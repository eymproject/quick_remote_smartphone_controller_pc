@echo off
chcp 65001 >nul
title QRSC_PC è‡ªå‹•èµ·å‹•å‰Šé™¤

echo.
echo ========================================
echo   QRSC_PC è‡ªå‹•èµ·å‹•å‰Šé™¤
echo ========================================
echo.
echo ã“ã®ãƒ„ãƒ¼ãƒ«ã¯QRSC_PCã®è‡ªå‹•èµ·å‹•è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ã€‚
echo ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã‚„ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
echo.
echo å‰Šé™¤å†…å®¹:
echo - Windowsèµ·å‹•æ™‚ã®è‡ªå‹•èµ·å‹•è¨­å®š
echo - ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¨ãƒ³ãƒˆãƒª: "QRSC_PC"
echo.

:: ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
    echo.
    echo è§£æ±ºæ–¹æ³•:
    echo 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
    echo 2. "ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œ" ã‚’é¸æŠž
    echo 3. UACï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ï¼‰ã§ã€Œã¯ã„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 1
)

echo âœ“ ç®¡ç†è€…æ¨©é™ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
echo.

:: ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
echo âš ï¸  æœ¬å½“ã«QRSC_PCã®è‡ªå‹•èµ·å‹•è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ
echo.
echo å‰Šé™¤ã™ã‚‹ã¨:
echo - Windowsèµ·å‹•æ™‚ã«QRSC_PCãŒè‡ªå‹•èµ·å‹•ã—ãªããªã‚Šã¾ã™
echo - æ‰‹å‹•ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
echo - å†åº¦è‡ªå‹•èµ·å‹•ã—ãŸã„å ´åˆã¯ install_autostart.bat ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
echo.
set /p confirm="å‰Šé™¤ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ (y/N): "

if /i not "%confirm%"=="y" (
    echo.
    echo ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚è¨­å®šã¯å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 0
)

echo.
echo è‡ªå‹•èµ·å‹•è¨­å®šã‚’å‰Šé™¤ä¸­...
echo.

:: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‹ã‚‰è‡ªå‹•èµ·å‹•ã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤
reg delete "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "QRSC_PC" /f >nul 2>&1

if %errorlevel% == 0 (
    echo.
    echo âœ… è‡ªå‹•èµ·å‹•è¨­å®šã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼
    echo.
    echo å‰Šé™¤ã•ã‚ŒãŸè¨­å®š:
    echo - ç™»éŒ²å: QRSC_PC
    echo - å ´æ‰€: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
    echo.
    echo ðŸ“ æ³¨æ„äº‹é …:
    echo - æ¬¡å›žã®Windowsèµ·å‹•æ™‚ã‹ã‚‰QRSC_PCã¯è‡ªå‹•èµ·å‹•ã—ã¾ã›ã‚“
    echo - qrsc_pc.exeã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
    echo - å†åº¦è‡ªå‹•èµ·å‹•ã—ãŸã„å ´åˆã¯ install_autostart.bat ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
    echo.
    echo ðŸ“ ç¾åœ¨å®Ÿè¡Œä¸­ã®QRSC_PCã«ã¤ã„ã¦:
    echo - ç¾åœ¨å®Ÿè¡Œä¸­ã®QRSC_PCã¯ç¶™ç¶šã—ã¦å‹•ä½œã—ã¾ã™
    echo - ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ¬ã‚¤ã‹ã‚‰çµ‚äº†ã™ã‚‹ã‹ã€PCã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„
    echo.
) else (
    echo.
    echo âš ï¸  è‡ªå‹•èµ·å‹•è¨­å®šã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚
    echo.
    echo è€ƒãˆã‚‰ã‚Œã‚‹åŽŸå› :
    echo - è©²å½“ã™ã‚‹ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¨ãƒ³ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„
    echo - ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ä¸è¶³
    echo - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚½ãƒ•ãƒˆã«ã‚ˆã‚‹å¹²æ¸‰
    echo.
    echo æ‰‹å‹•å‰Šé™¤æ–¹æ³•:
    echo 1. Win + R â†’ "regedit" â†’ Enter
    echo 2. HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run ã«ç§»å‹•
    echo 3. "QRSC_PC" ã‚¨ãƒ³ãƒˆãƒªã‚’å³ã‚¯ãƒªãƒƒã‚¯ â†’ å‰Šé™¤
    echo.
    echo ã¾ãŸã¯:
    echo 1. Win + R â†’ "msconfig" â†’ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¿ãƒ–
    echo 2. "QRSC_PC" ã‚’ç„¡åŠ¹ã«ã™ã‚‹
    echo.
)

echo.
echo è¨­å®šç¢ºèªæ–¹æ³•:
echo 1. Win + R â†’ "msconfig" â†’ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¿ãƒ–
echo 2. ã¾ãŸã¯ ã‚¿ã‚¹ã‚¯ãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼ â†’ ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¿ãƒ–
echo 3. "QRSC_PC" ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª
echo.
echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
pause >nul
