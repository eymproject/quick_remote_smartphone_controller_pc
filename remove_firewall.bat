@echo off
chcp 65001 >nul
title EYM Agent ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šå‰Šé™¤

echo.
echo ========================================
echo   EYM Agent ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šå‰Šé™¤
echo ========================================
echo.
echo ã“ã®ãƒ„ãƒ¼ãƒ«ã¯EYM Agentã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ã€‚
echo ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã‚„ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
echo.
echo å‰Šé™¤å†…å®¹:
echo - ãƒãƒ¼ãƒˆ8080ï¼ˆTCPï¼‰ã®å—ä¿¡è¨±å¯ãƒ«ãƒ¼ãƒ«
echo - ãƒ—ãƒ­ã‚°ãƒ©ãƒ å: "EYM Agent"
echo.

:: ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
    echo.
    echo è§£æ±ºæ–¹æ³•:
    echo 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
    echo 2. "ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œ" ã‚’é¸æŠž
    echo 3. UACï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ï¼‰ã§ã€Œã¯ã„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 1
)

echo âœ“ ç®¡ç†è€…æ¨©é™ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
echo.

:: ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
echo âš ï¸  æœ¬å½“ã«EYM Agentã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ
echo.
echo å‰Šé™¤ã™ã‚‹ã¨:
echo - ã‚¹ãƒžãƒ›ã‹ã‚‰PCã¸ã®æŽ¥ç¶šãŒã§ããªããªã‚Šã¾ã™
echo - å†åº¦ä½¿ç”¨ã™ã‚‹å ´åˆã¯ setup_firewall.bat ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
echo.
set /p confirm="å‰Šé™¤ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ (y/N): "

if /i not "%confirm%"=="y" (
    echo.
    echo ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚è¨­å®šã¯å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 0
)

echo.
echo ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ä¸­...
echo.

:: EYM Agentã®ãƒ«ãƒ¼ãƒ«ã‚’å‰Šé™¤
netsh advfirewall firewall delete rule name="EYM Agent"

if %errorlevel% == 0 (
    echo.
    echo âœ… ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼
    echo.
    echo å‰Šé™¤ã•ã‚ŒãŸè¨­å®š:
    echo - ãƒ«ãƒ¼ãƒ«å: EYM Agent
    echo - ãƒãƒ¼ãƒˆ: 8080ï¼ˆTCPï¼‰
    echo.
    echo ðŸ“ æ³¨æ„äº‹é …:
    echo - EYM Agentã¯æ­£å¸¸ã«å‹•ä½œã—ãªããªã‚Šã¾ã™
    echo - å†åº¦ä½¿ç”¨ã™ã‚‹å ´åˆã¯ setup_firewall.bat ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
    echo.
) else (
    echo.
    echo âš ï¸  ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚
    echo.
    echo è€ƒãˆã‚‰ã‚Œã‚‹åŽŸå› :
    echo - è©²å½“ã™ã‚‹ãƒ«ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ãªã„
    echo - Windows Defenderãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãŒç„¡åŠ¹
    echo - ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹åˆ¶é™
    echo.
    echo æ‰‹å‹•å‰Šé™¤æ–¹æ³•:
    echo 1. Windowsè¨­å®š â†’ Windows ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
    echo 2. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¿è­· â†’ è©³ç´°è¨­å®š
    echo 3. å—ä¿¡ã®è¦å‰‡ â†’ "EYM Agent" ã‚’å³ã‚¯ãƒªãƒƒã‚¯ â†’ å‰Šé™¤
    echo.
)

echo.
echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
pause >nul
