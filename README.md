# EYM Agent - PC側アプリケーション

EYM (Easy Your Machine) AgentはスマートフォンからPCを遠隔操作するためのPC側アプリケーションです。

## 📋 必要な設定

### 1. ファイアウォール設定（重要）

EYM Agentが正常に動作するためには、Windows Defenderファイアウォールでポート8080を許可する必要があります。

#### 🚀 自動設定（推奨）

1. `setup_firewall.bat` を **右クリック**
2. **「管理者として実行」** を選択
3. UAC（ユーザーアカウント制御）で **「はい」** をクリック
4. 設定完了まで待機

#### 🔧 手動設定

1. Windows設定 → 更新とセキュリティ
2. Windows セキュリティ → ファイアウォールとネットワーク保護
3. 詳細設定 → 受信の規則 → 新しい規則
4. ポート → TCP → 特定のローカルポート: **8080**
5. 接続を許可する → すべてのプロファイル
6. 名前: **"EYM Agent"** → 完了

## 🚀 使用方法

### 1. EYM Agent起動

1. `qrsc_pc.exe` をダブルクリック
2. サーバーが自動的に起動します
3. IPアドレスとポート番号が表示されます

### 2. スマートフォンとの接続

#### QRコード接続（推奨）

1. EYM Agentで **「QRコード表示」** をクリック
2. スマートフォンのEYMアプリを起動
3. **「QRコードでかんたん接続」** をタップ
4. PC画面のQRコードをスキャン
5. 自動接続完了！

#### 手動接続

1. スマートフォンのEYMアプリで **「詳細設定（手動接続）」** をタップ
2. PC画面に表示されているIPアドレスとポートを入力
   - 例: `http://192.168.xxx.xxx:8080`
3. **「接続テスト」** をタップ
4. 接続成功を確認

### 3. IPアドレス設定

ネットワーク環境に応じてIPアドレスを変更できます：

1. **「IP設定」** ボタンをクリック
2. 実際のIPアドレスを入力
3. **「設定」** をクリック
4. サーバーが自動的に再起動

## 🔧 トラブルシューティング

### 接続できない場合

1. **ファイアウォール設定を確認**
   - `setup_firewall.bat` を管理者として実行
   
2. **同じWi-Fiネットワークに接続**
   - PCとスマートフォンが同じWi-Fiに接続されているか確認
   
3. **IPアドレスを確認**
   - コマンドプロンプトで `ipconfig` を実行
   - IPv4アドレスをEYM Agentで設定

### ファイアウォール設定を削除したい場合

1. `remove_firewall.bat` を **右クリック**
2. **「管理者として実行」** を選択
3. 削除確認で **「y」** を入力

## 📁 ファイル構成

```
EYM Agent/
├── qrsc_pc.exe          # メインアプリケーション
├── setup_firewall.bat    # ファイアウォール設定
├── remove_firewall.bat   # ファイアウォール設定削除
└── README.md             # このファイル
```

## ⚙️ 設定ファイル

EYM Agentの設定は以下の場所に保存されます：
- Windows: `%APPDATA%\EYM Agent\`

## 🔒 セキュリティについて

- EYM Agentはローカルネットワーク内でのみ動作します
- インターネット経由での接続はできません
- ファイアウォール設定は必要最小限のポート（8080）のみを許可します

## 📞 サポート

問題が発生した場合：

1. ファイアウォール設定を再実行
2. PCとスマートフォンのWi-Fi接続を確認
3. EYM Agentを再起動

## 🎯 システム要件

- **OS**: Windows 10/11
- **ネットワーク**: Wi-Fi接続
- **権限**: 管理者権限（初回設定時のみ）
- **ポート**: 8080（TCP）

---

**EYM Agent v1.0.0**  
Easy Your Machine - スマートフォンでPCを簡単操作
