@echo off
chcp 65001 >nul
title EYM Agent ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š

echo.
echo ========================================
echo   EYM Agent ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š
echo ========================================
echo.
echo ã“ã®ãƒ„ãƒ¼ãƒ«ã¯EYM AgentãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ãŸã‚ã«
echo Windows Defenderãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚
echo.
echo è¨­å®šå†…å®¹:
echo - ãƒãƒ¼ãƒˆ8080ï¼ˆTCPï¼‰ã®å—ä¿¡ã‚’è¨±å¯
echo - ãƒ—ãƒ­ã‚°ãƒ©ãƒ å: "EYM Agent"
echo.

:: ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚
    echo.
    echo è§£æ±ºæ–¹æ³•:
    echo 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
    echo 2. "ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œ" ã‚’é¸æŠž
    echo 3. UACï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ï¼‰ã§ã€Œã¯ã„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    echo.
    echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
    pause >nul
    exit /b 1
)

echo âœ“ ç®¡ç†è€…æ¨©é™ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
echo.
echo ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’é–‹å§‹ã—ã¾ã™...
echo.

:: æ—¢å­˜ã®ãƒ«ãƒ¼ãƒ«ã‚’å‰Šé™¤ï¼ˆé‡è¤‡é˜²æ­¢ï¼‰
echo æ—¢å­˜ã®è¨­å®šã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­...
netsh advfirewall firewall delete rule name="EYM Agent" >nul 2>&1

:: æ–°ã—ã„ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ 
echo ãƒãƒ¼ãƒˆ8080ã®å—ä¿¡è¨±å¯ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ä¸­...
netsh advfirewall firewall add rule name="EYM Agent" dir=in action=allow protocol=TCP localport=8080 profile=any

if %errorlevel% == 0 (
    echo.
    echo âœ… ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸï¼
    echo.
    echo è¨­å®šå†…å®¹:
    echo - ãƒ«ãƒ¼ãƒ«å: EYM Agent
    echo - æ–¹å‘: å—ä¿¡
    echo - ãƒ—ãƒ­ãƒˆã‚³ãƒ«: TCP
    echo - ãƒãƒ¼ãƒˆ: 8080
    echo - å‹•ä½œ: è¨±å¯
    echo - ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«: ã™ã¹ã¦ï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã€ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰
    echo.
    echo ðŸŽ‰ EYM AgentãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼
    echo.
    echo æ¬¡ã®æ‰‹é †:
    echo 1. EYM Agentã‚’èµ·å‹•
    echo 2. ã‚¹ãƒžãƒ›ã§QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³
    echo 3. æŽ¥ç¶šå®Œäº†ï¼
    echo.
) else (
    echo.
    echo âŒ ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸã€‚
    echo.
    echo è€ƒãˆã‚‰ã‚Œã‚‹åŽŸå› :
    echo - Windows Defenderãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãŒç„¡åŠ¹
    echo - ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹åˆ¶é™
    echo - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚½ãƒ•ãƒˆã«ã‚ˆã‚‹å¹²æ¸‰
    echo.
    echo æ‰‹å‹•è¨­å®šæ–¹æ³•:
    echo 1. Windowsè¨­å®š â†’ æ›´æ–°ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
    echo 2. Windows ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â†’ ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¿è­·
    echo 3. è©³ç´°è¨­å®š â†’ å—ä¿¡ã®è¦å‰‡ â†’ æ–°ã—ã„è¦å‰‡
    echo 4. ãƒãƒ¼ãƒˆ â†’ TCP â†’ ç‰¹å®šã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ¼ãƒˆ: 8080
    echo 5. æŽ¥ç¶šã‚’è¨±å¯ã™ã‚‹ â†’ ã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    echo 6. åå‰: "EYM Agent" â†’ å®Œäº†
    echo.
)

echo.
echo è¨­å®šç¢ºèªæ–¹æ³•:
echo Windowsè¨­å®š â†’ Windows ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â†’ ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¿è­·
echo â†’ è©³ç´°è¨­å®š â†’ å—ä¿¡ã®è¦å‰‡ â†’ "EYM Agent" ã‚’ç¢ºèª
echo.
echo ä½•ã‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦çµ‚äº†...
pause >nul
